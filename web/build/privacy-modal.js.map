{"version":3,"sources":["webpack:///./node_modules/progressive-web-sdk/dist/utils/cookie-manager.js","webpack:///./app/modals/privacy/actions.js","webpack:///./app/modals/privacy/index.jsx"],"names":["Object","defineProperty","exports","value","_keys2","_interopRequireDefault","__webpack_require__","_classCallCheck3","_createClass3","obj","__esModule","default","POLL_TIME_INTERVAL","POLL_TIME_LIMIT","pollStartTime","nextSubscriberKey","subscribers","CookieSubscriber","name","updateCallback","this","cookieName","_subscribePosition","key","cookieManager","CookieManager","pollTimeLimit","pollTimeInterval","RegExp","exec","document","cookie","domain","lifetime","expires","Date","now","setExpiry","setTime","toGMTString","defaultValue","arguments","length","undefined","cookieMatch","isCookieSet","_this","cookieValue","get","cookieSubscribers","forEach","setTimeout","_pollForCookieUpdate","_this2","setPrivacyCookie","time","dispatch","set","location","hostname","PrivacyModal","_ref","acceptPrivacyCookie","isOpen","closeThisModal","duration","react_default","a","createElement","sheet_default","className","open","onDismiss","maskOpacity","effect","coverage","shrinkToContent","icon_default","button_default","icon","text","data-analytics-name","onClick","href","openInNewTab","propTypes","PropTypes","func","number","bool","mapStateToProps","createPropsSelector","isModalOpen","PRIVACY_MODAL","mapDispatchToProps","stripEvent","closeModal","connect"],"mappings":"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","file":"privacy-modal.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _keys = require('babel-runtime/core-js/object/keys');\n\nvar _keys2 = _interopRequireDefault(_keys);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */\n/* Copyright (c) 2018 Mobify Research & Development Inc. All rights reserved. */\n/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */\n\nvar POLL_TIME_INTERVAL = 50;\nvar POLL_TIME_LIMIT = 3000;\n\nvar pollStartTime = void 0;\n\nvar nextSubscriberKey = 0;\nvar subscribers = {};\n\nvar CookieSubscriber = function () {\n    function CookieSubscriber(name, updateCallback) {\n        (0, _classCallCheck3.default)(this, CookieSubscriber);\n\n        /* istanbul ignore else */\n        if (!subscribers[name]) {\n            subscribers[name] = {};\n        }\n\n        this.updateCallback = updateCallback;\n        this.cookieName = name;\n        this._subscribePosition = nextSubscriberKey;\n\n        subscribers[name][this._subscribePosition] = this;\n\n        nextSubscriberKey++;\n    }\n\n    (0, _createClass3.default)(CookieSubscriber, [{\n        key: 'unsubscribe',\n        value: function unsubscribe() {\n            delete subscribers[this.cookieName][this._subscribePosition];\n        }\n    }]);\n    return CookieSubscriber;\n}();\n\n// This class is a singleton\n\n\nvar CookieManager = function () {\n    function CookieManager() {\n        (0, _classCallCheck3.default)(this, CookieManager);\n\n        this.pollTimeLimit = POLL_TIME_LIMIT;\n        this.pollTimeInterval = POLL_TIME_INTERVAL;\n    }\n\n    (0, _createClass3.default)(CookieManager, [{\n        key: 'isCookieSet',\n        value: function isCookieSet(name) {\n            var cookieRegex = new RegExp(name + '=([^;]+)');\n            return cookieRegex.exec(document.cookie);\n        }\n    }, {\n        key: 'set',\n        value: function set(name, value, domain, lifetime) {\n            var expires = new Date();\n            var now = Date.now();\n            var setExpiry = lifetime > 0;\n\n            if (setExpiry) {\n                expires.setTime(now + lifetime);\n            }\n\n            /* istanbul ignore next */\n            document.cookie = name + '=' + value + ';' + (setExpiry ? ' expires=' + expires.toGMTString() + ';' : '') + ' path=/; ' + (domain && domain !== 'localhost' ? 'domain=' + domain : '');\n        }\n    }, {\n        key: 'get',\n        value: function get(name) {\n            var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n            var cookieMatch = this.isCookieSet(name);\n\n            return cookieMatch ? cookieMatch[1] : defaultValue;\n        }\n    }, {\n        key: 'subscribe',\n        value: function subscribe(name, updateCallback) {\n            return new CookieSubscriber(name, updateCallback);\n        }\n    }, {\n        key: '_pollForCookieUpdate',\n        value: function _pollForCookieUpdate(cookieName) {\n            var _this = this;\n\n            var cookieValue = this.get(cookieName);\n\n            /* istanbul ignore else */\n            if (cookieValue) {\n                var cookieSubscribers = subscribers[cookieName];\n\n                (0, _keys2.default)(cookieSubscribers).forEach(function (key) {\n                    cookieSubscribers[key].updateCallback(cookieValue);\n                });\n            } else {\n                /* istanbul ignore else */\n                if (cookieName && cookieName !== '' && Date.now() - pollStartTime < this.pollTimeLimit) {\n                    setTimeout(function () {\n                        _this._pollForCookieUpdate(cookieName);\n                    }, this.pollTimeInterval);\n                }\n            }\n        }\n    }, {\n        key: 'pollForAllCookieUpdate',\n        value: function pollForAllCookieUpdate() {\n            var _this2 = this;\n\n            pollStartTime = Date.now();\n            (0, _keys2.default)(subscribers).forEach(function (key) {\n                if ((0, _keys2.default)(subscribers[key]).length) {\n                    _this2._pollForCookieUpdate(key);\n                }\n            });\n        }\n    }]);\n    return CookieManager;\n}();\n\nvar cookieManager = new CookieManager();\n\nexports.default = cookieManager;","/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */\n/* Copyright (c) 2018 Mobify Research & Development Inc. All rights reserved. */\n/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */\n\nimport cookieManager from 'progressive-web-sdk/dist/utils/cookie-manager'\n\n// Value of false = privacy notice was dismissed or ignored\n// Value of true = privacy notice was accepted\nconst setPrivacyCookie = (value, time) => (dispatch) => {\n    cookieManager.set('privacy-notice', value, location.hostname, time)\n}\n\nexport const acceptPrivacyCookie = () => (dispatch) => {\n    const tenYears = 10 * 365 * 24 * 60 * 60 * 1000\n    dispatch(setPrivacyCookie(true, tenYears))\n}\n\nexport const ignorePrivacyCookie = () => (dispatch) => {\n    const sixtyDays = 60 * 24 * 60 * 60 * 1000\n    dispatch(setPrivacyCookie(false, sixtyDays))\n}\n","/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */\n/* Copyright (c) 2018 Mobify Research & Development Inc. All rights reserved. */\n/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */\n\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport {connect} from 'react-redux'\nimport {createPropsSelector} from 'reselect-immutable-helpers'\n\nimport Button from 'progressive-web-sdk/dist/components/button'\nimport Icon from 'progressive-web-sdk/dist/components/icon'\nimport Sheet from 'progressive-web-sdk/dist/components/sheet'\nimport {isModalOpen} from 'progressive-web-sdk/dist/store/modals/selectors'\n\nimport {stripEvent} from 'progressive-web-sdk/dist/utils/utils'\nimport {closeModal} from '../actions'\nimport {PRIVACY_MODAL} from '../constants'\nimport {acceptPrivacyCookie} from './actions'\n\n\nconst PrivacyModal = ({\n    acceptPrivacyCookie,\n    isOpen,\n    closeThisModal,\n    duration,\n}) => {\n    return (\n        <Sheet\n            className=\"m-privacy\"\n            open={isOpen}\n            onDismiss={closeThisModal}\n            duration={duration}\n            maskOpacity={0}\n            effect=\"slide-bottom\"\n            coverage=\"40%\"\n            shrinkToContent={true}\n        >\n            <div className=\"u-flexbox u-align-center u-padding-end-0 u-padding-start-md u-padding-top u-padding-bottom-sm\">\n                <Icon name=\"lock\" className=\"u-flex-none u-margin-end-md\" />\n\n                <h1 className=\"u-h5 u-text-family u-text-weight-bold u-flex\">\n                    We care about your privacy\n                </h1>\n\n                <Button\n                    icon=\"close\"\n                    text=\"Close\"\n                    className=\"u-flex-none\"\n                    data-analytics-name=\"privacy_modal:dismiss\"\n                    onClick={closeThisModal}\n                />\n            </div>\n\n            <p className=\"u-text-size-medium u-padding-start-md u-padding-end-md\">\n                Allow us to track details of your visit today to present great recommendations and keep your saved items for next time.\n            </p>\n\n            <div className=\"u-flexbox u-padding-md u-padding-end-0\">\n                <Button\n                    className=\"pw--secondary u-margin-end u-flex\"\n                    text=\"Accept\"\n                    data-analytics-name=\"privacy_modal:accept\"\n                    onClick={() => {\n                        acceptPrivacyCookie()\n                        closeThisModal()\n                    }}\n                />\n\n                <Button\n                    className=\"pw--tertiary u-flex\"\n                    text=\"Decline\"\n                    data-analytics-name=\"privacy_modal:decline\"\n                    onClick={closeThisModal}\n                />\n\n                <Button\n                    className=\"u-flex-none\"\n                    href=\"/privacy-policy-cookie-restriction-mode\"\n                    openInNewTab={true}\n                    data-analytics-name=\"privacy_modal:tell_me_more\"\n                    text=\"Tell me more\"\n                />\n            </div>\n\n            <p className=\"u-padding-start-md u-padding-end-md u-padding-bottom-lg u-color-neutral-50\">\n                We don't share your data with anyone else.\n            </p>\n        </Sheet>\n    )\n}\n\nPrivacyModal.propTypes = {\n    acceptPrivacyCookie: PropTypes.func,\n    closeThisModal: PropTypes.func,\n    duration: PropTypes.number,\n    isOpen: PropTypes.bool,\n}\n\nconst mapStateToProps = createPropsSelector({\n    isOpen: isModalOpen(PRIVACY_MODAL),\n})\n\nconst mapDispatchToProps = {\n    acceptPrivacyCookie: stripEvent(() => acceptPrivacyCookie()),\n    closeThisModal: stripEvent(() => closeModal(PRIVACY_MODAL))\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(PrivacyModal)\n"],"sourceRoot":""}